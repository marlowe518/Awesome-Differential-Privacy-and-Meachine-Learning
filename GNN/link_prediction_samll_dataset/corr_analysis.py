import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt


def plot_trend_list(data_list, label_list):
    for idx, (data, label) in enumerate(zip(data_list, label_list)):
        plt.plot(data, label=label)
        print(idx, data, label)
    plt.grid()
    plt.legend(loc="best")
    plt.show()

def val_trend(data):
    arr = np.array(data)
    plt.plot(arr, label="val")
    plt.grid()
    plt.legend(loc="best")
    plt.show()


def main():
    cols = ["dataset",
            "max_node_degree",
            "num_hop",
            "highest_val",
            "final_test",
            "best_epoch",
            "original_edges",
            "sampled_edges",
            "max_term_per_edge",
            "epsilon",
            "sigma",
            "lr",
            "max_norm",
            "batch_size",
            "train_samples"]
    data = pd.read_csv("./results/all_results_20230623140423.csv", header=0, usecols=cols)
    groups = data.groupby("dataset")
    for name, group in groups:
        print(name)
        correlation_matrix = group.corr()
        target_correlation = correlation_matrix["final_test"]
        print(target_correlation)
        sns.heatmap(correlation_matrix, fmt=".2g", linewidths=0, annot=True, cmap='coolwarm')
        plt.title(f"Correlation Matrix {name}")
        plt.show()


if __name__ == "__main__":
    # main()

    # raw_data = [(0.5173794801328295, 0.10789840290793223), (0.470849078209092, 0.0916359724468582), (0.28551471430207265, 0.05557856200294442), (0.18446696438795374, 0.06636442398783522), (0.18618172449330128, 0.09401969889575255), (0.2382371464559716, 0.48464769425765275), (0.766311691285927, 0.9415677596228471), (0.814868888125501, 0.9467844586433), (0.815115080728272, 0.9427819571962203), (0.8142104660483225, 0.9319232759278526), (0.7764428031604259, 0.9156908572481476), (0.6484770411084393, 0.8949278228290546), (0.6006154815069277, 0.8685944621981839), (0.5392505439138898, 0.8468296391699812), (0.49845413947097217, 0.8419637755472382), (0.4849851139356464, 0.8390500736102917), (0.44271441658078553, 0.8291948094973096), (0.32428432382915384, 0.7851724118677286), (0.286336310546204, 0.7367515433965706), (0.2973920760334364, 0.705322461468595), (0.3369718309859155, 0.6331250500196357), (0.42519466391847016, 0.49055675809480553), (0.49594354746364355, 0.4807405790924437), (0.616096988434673, 0.4976658278877848), (0.6340833619603803, 0.5144542787959552), (0.633768464445208, 0.5186163777780672), (0.6357866712469941, 0.5235455220561002), (0.6308170159166381, 0.5265685692429959), (0.633115767777396, 0.5322738321462006), (0.6219111416466276, 0.5319015929974371), (0.5300154586052904, 0.5378662600574364), (0.4595786098706057, 0.5443632291001677), (0.39234512767662894, 0.5468004649266969), (0.334758960265659, 0.555900316217157), (0.3943203939081644, 0.5723507274483565), (0.44608668269781293, 0.5794356016966661), (0.5506126188022444, 0.5746902504983351), (0.6099765258215962, 0.5758265104999357), (0.7056338028169015, 0.5916857594330053), (0.8121779457231192, 0.6859974334110692), (0.8105490667582732, 0.6825081566903474), (0.8035869689682812, 0.6652160196840062), (0.7943089430894309, 0.6030395187692285), (0.7568246879651894, 0.3097913785690755), (0.7361731363792511, 0.2894871289008336), (0.7319391961525249, 0.25522530705076785), (0.7303561204626131, 0.24388504138368736), (0.7305822741326004, 0.24551265706165584), (0.7302301614565441, 0.24146897665874423), (0.7296146799496164, 0.24220949991531562)]
    # data_list = [raw_data]
    # val_test_trend(data_list)
    # raw_data = [[], [], [], []]
    raw_data = [
        [
            0.29839620052377697, 0.30120161691715863, 0.3025881838522261, 0.3064403168711072, 0.3113490280355573,
            0.3140698772426818, 0.3312554366281044, 0.34399586932555576, 0.3689236522976877, 0.40660489261641947,
            0.4349268061234458, 0.44160463677509687, 0.5036724858938398, 0.5956809333091446, 0.6329518971796982,
            0.6393630016234295, 0.6451464110114106, 0.6684289947296688, 0.6716977164999045, 0.7577121273438554,
            0.7986900924284924, 0.8143410690445956, 0.8271102490033819, 0.8293516980886327, 0.8482776296999214,
            0.8486038041278835, 0.8491326048833132, 0.8490951125004071, 0.8492838768798524, 0.8493570009815004,
            0.8493530005535476, 0.849302018355452, 0.849215218372198, 0.8494691059973858, 0.8492532689543533,
            0.8494274271201107, 0.8680544430334409, 0.8680746312396209, 0.8682247868376619, 0.868133521260414,
            0.8681456155774805, 0.8680450466794124, 0.8679107997599743, 0.8680339757276361, 0.8680882140880188,
            0.8680799341324887, 0.8682480451397128, 0.8681704554440708, 0.8681360331570355, 0.8682135298194693
        ],
        [
            0.2982519990510613, 0.30135847090618995, 0.30247031077743197, 0.3086364587839629, 0.3112017564669709,
            0.32001646687785207, 0.339862962084316, 0.35227359205868536, 0.37278853086609265, 0.41742939942412444,
            0.43491834010149927, 0.454027454099741, 0.4826774026988934, 0.5360755801783446, 0.6341300697283895,
            0.687730222302851, 0.6905608506956559, 0.6961825683677789, 0.6982755364527369, 0.6993164850193277,
            0.7605251724603097, 0.7926717741897971, 0.8303976704484667, 0.8490865534452523, 0.8492004260920938,
            0.8492685264004987, 0.8492887146066789, 0.8493465812621815, 0.8492547574856847, 0.849271875595994,
            0.849391144168911, 0.8492208933978984, 0.8490819948180505, 0.8681697111784052, 0.8679703410132248,
            0.8679649450871489, 0.8682450680770503, 0.8680295101336423, 0.8680962149439242, 0.8680870976895203,
            0.8679694106811426, 0.8681168683161455, 0.8679914595514869, 0.8680238351079417, 0.8681738046395662,
            0.8680417905171252, 0.8680096010270868, 0.8680888653204761, 0.8681439409797329, 0.8681765026026043
        ],
        [
            0.29689715643999126, 0.30142889704480014, 0.30241858431367075, 0.3087601929508738, 0.3128904022290757,
            0.32058257394977135, 0.3475912306897947, 0.36123315517473964, 0.39922159114695993, 0.4351585518450811,
            0.44706745372760814, 0.4704285574735902, 0.4832016448271211, 0.5057814556906088, 0.6535695446489627,
            0.6881587332598371, 0.6938873460881863, 0.6983718258232277, 0.7177236634616728, 0.7628321169241362,
            0.7925054308135289, 0.8488884857449868, 0.8490785525893468, 0.8493284397865818, 0.8492604325113848,
            0.8492277778553057, 0.8493555124501692, 0.8493022044218685, 0.8492670378691674, 0.8493486279927621,
            0.8492916916693414, 0.8681738046395662, 0.8680870976895203, 0.8682514873684163, 0.8679623401573192,
            0.8680592807602675, 0.8680517450704028, 0.868037510989548, 0.8680125780897493, 0.8681121236225271,
            0.8681636640198718, 0.868162268521749, 0.8680937960805111, 0.8682070174948949, 0.868126636803007,
            0.8682005051703208, 0.8680990989733788, 0.8680756546049114, 0.8680196486135727, 0.8681331491275813
        ],
        [
            0.2968199388771822, 0.2990989733785475, 0.3027360136200617, 0.3088620643138568, 0.3128784939784256,
            0.3270889443987032, 0.34771310419254153, 0.36110663001158266, 0.406441154169981, 0.43512747875354113,
            0.4538665996827568, 0.47043646529628746, 0.4830002279313602, 0.5034685571014574, 0.6536159682198561,
            0.6884718830386507, 0.6941041134633007, 0.698561520534755, 0.7376276531908065, 0.7834689292342902,
            0.7928225810202953, 0.8490991129283598, 0.8492196839661919, 0.8491641431408942, 0.849372351460854,
            0.8492497336924416, 0.8494383120054705, 0.8492040543872136, 0.8493852830767944, 0.8491807960851625,
            0.8680829111951512, 0.8681482205073102, 0.8680963079771326, 0.8682722337738455, 0.8681084953274072,
            0.8680395577201285, 0.8678720049121535, 0.868162268521749, 0.868136684389493, 0.8680890513868927,
            0.8681632918870392, 0.8681039367002052, 0.8680645836531351, 0.8682003191039043, 0.8681067276964513,
            0.8681460807435215, 0.8681162170836881, 0.8681036576005807, 0.8679643868878998, 0.868048116775283
        ]
    ]
    plot_trend_list(raw_data, ["eps=5","eps=10","eps=20","eps=25"])